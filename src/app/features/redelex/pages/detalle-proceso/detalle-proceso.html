<div class="page-container">
  <div class="mb-6">
    <a routerLink="/panel/consultas/mis-procesos" class="back-link">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
      Volver al listado
    </a>
  </div>

  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>Cargando expediente digital...</p>
  </div>

  <div *ngIf="error" class="error-state">
    <div class="error-icon">⚠️</div>
    <h3>No pudimos cargar el proceso</h3>
    <p>{{ error }}</p>
    <button class="btn btn--secondary" routerLink="/panel/consultas/mis-procesos">Regresar</button>
  </div>

  <div *ngIf="!loading && !error && detalle" class="fade-in">
    
    <header class="process-header">
      <div class="header-top">
        <span class="badge badge--primary">{{ detalle.claseProceso || 'Proceso' }}</span>
        <span class="badge" [ngClass]="detalle.estado === 'ACTIVO' ? 'badge--success' : 'badge--neutral'">
          {{ detalle.estado || 'Sin Estado' }}
        </span>
      </div>
      
      <h1 class="radicado-title">
        Radicado: {{ detalle.numeroRadicacion || 'Sin Número' }}
      </h1>
      
      <div class="header-meta">
        <div class="meta-item">
          <span class="label">ID Interno:</span>
          <span class="value">#{{ detalle.idProceso }}</span>
        </div>
        <div class="meta-item">
          <span class="label">Despacho:</span>
          <span class="value">{{ detalle.despacho }}</span>
        </div>
        <div class="meta-item">
          <span class="label">Ciudad:</span>
          <span class="value">{{ detalle.regional || 'N/A' }}</span>
        </div>
      </div>
    </header>

    <div class="details-grid">
      
      <div class="details-col">
        
        <section class="info-card">
          <h3>Partes Procesales</h3>
          
          <div class="parties-list">
            
            <div class="party-group" *ngIf="sujetoDemandante.length > 0">
              <h4 class="group-title text-green">Demandante(s)</h4>
              <div class="party-item party-item--demandante" *ngFor="let s of sujetoDemandante">
                <div class="party-name">{{ s.Nombre || s.RazonSocial }}</div>
                <div class="party-id">{{ s.Identificacion }}</div>
              </div>
            </div>

            <div class="party-group" *ngIf="sujetoDemandado.length > 0">
              <h4 class="group-title text-red">Demandado(s)</h4>
              <div class="party-item party-item--demandado" *ngFor="let s of sujetoDemandado">
                <div class="party-name">{{ s.Nombre || s.RazonSocial }}</div>
                <div class="party-id">{{ s.Identificacion }}</div>
              </div>
            </div>

            <div class="party-group" *ngIf="sujetosSolidarios.length > 0">
              <h4 class="group-title">Deudores Solidarios</h4>
              <div class="party-item" *ngFor="let s of sujetosSolidarios">
                <div class="party-name">{{ s.Nombre || s.RazonSocial }}</div>
                <div class="party-id">{{ s.Identificacion }}</div>
              </div>
            </div>

            <div class="party-group" *ngIf="otrosSujetos.length > 0">
              <h4 class="group-title">Otros Sujetos</h4>
              <div class="party-item" *ngFor="let s of otrosSujetos">
                <div class="party-role-badge">{{ s.Tipo }}</div>
                <div class="party-name">{{ s.Nombre || s.RazonSocial }}</div>
                <div class="party-id">{{ s.Identificacion || s.NumeroIdentificacion }}</div>
              </div>
            </div>

          </div>
        </section>

        <section class="info-card mt-4" *ngIf="detalle.medidasCautelares?.length > 0">
          <h3>Medidas Cautelares</h3>
          
          <div class="medidas-list">
            <div class="medida-card" *ngFor="let medida of detalle.medidasCautelares">
              <div class="medida-header">
                <span class="medida-type">{{ medida.tipoBien || 'Medida Cautelar' }}</span>
                <span class="medida-status">{{ medida.medidaEfectiva === 'S' ? 'Efectiva' : 'Pendiente' }}</span>
              </div>
              <div class="medida-body">
                <p><strong>Medida:</strong> {{ medida.tipoMedida }}</p>
                <p *ngIf="medida.avaluoJudicial"><strong>Avalúo:</strong> {{ medida.avaluoJudicial | currency }}</p>
              </div>
            </div>
          </div>
        </section>
      </div>

      <div class="details-col">
        <section class="info-card">
          <h3>Últimas Actuaciones</h3>
          <div class="timeline">
            <div *ngIf="!detalle.actuaciones?.length && !detalle.ultimaActuacionFecha" class="empty-timeline">
              No hay actuaciones registradas.
            </div>

            <div class="timeline-item" *ngIf="detalle.ultimaActuacionFecha">
              <div class="timeline-marker"></div>
              <div class="timeline-content">
                <div class="timeline-date">
                  {{ detalle.ultimaActuacionFecha | date:'mediumDate' }}
                </div>
                <div class="timeline-title">
                  {{ detalle.ultimaActuacionTipo }}
                </div>
                <div class="timeline-desc">
                  {{ detalle.ultimaActuacionObservacion }}
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>

    </div>
  </div>
</div>